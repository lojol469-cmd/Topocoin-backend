Parfait ! Maintenant que ton backend Topocoin fonctionne, voici un **README style Notion** pour documenter clairement **comment fonctionne la connexion backend, les fonctionnalit√©s, et comment l‚Äôutiliser**. Tu peux copier-coller directement dans Notion ou Markdown.

---

# ü™ô Topocoin Backend

## 1Ô∏è‚É£ Introduction

Ce backend est un serveur **Node.js/Express** pour g√©rer la crypto-monnaie **Topocoin** sur le r√©seau **Solana Testnet**.
Il g√®re :

* Gestion des utilisateurs (inscription, login)
* Stockage des wallets Solana (public/private key)
* D√©tection automatique de l‚Äôadresse IP
* JWT pour l‚Äôauthentification
* Envoi de Topocoin (Solana)
* Envoi d‚Äôemails via Gmail/Nodemailer
* WebSocket pour communication en temps r√©el

---

## 2Ô∏è‚É£ Pr√©requis

* Node.js ‚â• 20
* NPM
* MongoDB Atlas (ou local)
* Compte Gmail pour Nodemailer (email utilisateur + mot de passe d‚Äôapplication)

---

## 3Ô∏è‚É£ Installation

1. Cloner le projet :

```bash
git clone <ton-repo-url>
cd backend
```

2. Installer les d√©pendances :

```bash
npm install express mongoose dotenv body-parser jsonwebtoken nodemailer @solana/web3.js ws
```

3. Cr√©er un fichier `.env` :

```env
PORT=5000

MONGO_USER=SETRAF
MONGO_PASSWORD=Dieu19961991??!??!
MONGO_CLUSTER=cluster0.5tjz9v0.mongodb.net
MONGO_DB_NAME=myDatabase2
MONGO_URI=mongodb+srv://SETRAF:Dieu19961991%3F%3F%21%3F%3F%21@cluster0.5tjz9v0.mongodb.net/myDatabase2?retryWrites=true&w=majority&appName=Cluster0

JWT_SECRET=Dieu19961991??!??!
JWT_REFRESH_SECRET=Dieu19961991??!??!_refresh

EMAIL_USER=tonemail@gmail.com
EMAIL_PASS=motdepasse_app

PUBLIC_KEY=qazghazz
PRIVATE_KEY=264419a2-cd4e-471a-81b3-04c522669052
```

---

## 4Ô∏è‚É£ Lancer le serveur

```bash
node server
```

Tu devrais voir :

```
üöÄ Topocoin backend HTTP+WS running on port 5000
‚úÖ MongoDB connected
```

---

## 5Ô∏è‚É£ Endpoints API

### üîπ Test

```http
GET /
```

* Retourne un message de fonctionnement et l‚ÄôIP du client.

---

### üîπ Inscription

```http
POST /register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "123456"
}
```

* Cr√©e un utilisateur, g√©n√®re un wallet Solana Testnet et envoie un email de bienvenue.
* Stocke l‚Äôadresse IP du client.

---

### üîπ Login

```http
POST /login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "123456"
}
```

* Retourne un token JWT + info utilisateur + derni√®re IP d√©tect√©e.

---

### üîπ Envoyer Topocoin

```http
POST /send
Content-Type: application/json

{
  "fromPrivateKeyHex": "<cl√© priv√©e hex du wallet>",
  "toPublicKey": "<adresse publique du destinataire>",
  "amount": 0.1
}
```

* Transf√®re des Topocoin sur **Solana Testnet**.

---

## 6Ô∏è‚É£ WebSocket (Temps r√©el)

* Connexion WebSocket : `ws://localhost:5000`
* Chaque connexion re√ßoit l‚ÄôIP et un message de bienvenue.
* Messages envoy√©s par le client sont renvoy√©s en **echo**.

Exemple client JS :

```javascript
const ws = new WebSocket('ws://localhost:5000');

ws.onopen = () => console.log('Connect√© au WS');
ws.onmessage = (msg) => console.log('Message re√ßu:', msg.data);

ws.send('Salut serveur !');
```

---

## 7Ô∏è‚É£ D√©tection IP

* Le backend d√©tecte automatiquement l‚ÄôIP du client via :

```js
const clientIp = req.headers['x-forwarded-for'] || req.socket.remoteAddress;
```

* IP stock√©e dans MongoDB pour chaque utilisateur.

---

## 8Ô∏è‚É£ Notes importantes

* Les mots de passe sont **stock√©s en clair pour le test**, utiliser `bcrypt` en production.
* Cl√©s priv√©es Solana sont actuellement en clair : **√† s√©curiser pour production**.
* WebSocket et HTTP fonctionnent en local sans HTTPS, passer en HTTPS pour un d√©ploiement public.

---

üí° Ce README peut servir directement dans **Notion** pour documenter le projet, guider les d√©veloppeurs et tester les connexions backend.

---

Si tu veux, je peux te faire **une version visuelle Notion avec sch√©ma backend + flux de connexion + WebSocket** pr√™te √† copier-coller pour ton workspace.

Veux‚Äëtu que je fasse √ßa‚ÄØ?
